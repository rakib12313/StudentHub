<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StudentHub - Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- BACKGROUND -->
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>

    <!-- DESKTOP APP BAR -->
    <nav class="md-app-bar glass">
        <div class="logo-area" onclick="window.nav('home')">
            <div class="logo-icon glass-icon"><i class="fas fa-graduation-cap"></i></div>
            <span class="logo-text">StudentHub</span>
        </div>

        <div class="desktop-nav glass-panel">
            <button class="nav-item active" onclick="window.nav('home')">Home</button>
            <button class="nav-item" onclick="window.nav('files')">Library</button>
            <button class="nav-item" onclick="window.nav('drive')">Backup</button>
            <button class="nav-item" onclick="window.nav('about')">About</button>
            <button class="nav-item admin-trigger" onclick="window.handleAdminClick(event)">Admin</button>
        </div>

        <div class="action-area">
            <button id="login-btn" class="md-btn glass-btn glow-hover" onclick="window.googleLogin()">
                <i class="fas fa-sign-in-alt"></i> <span>Login</span>
            </button>

            <div id="profile-container" class="profile-wrapper" style="display: none;">
                <div class="profile-avatar ripple" onclick="window.toggleProfile(event)">
                    <img id="user-avatar" src="" alt="Profile">
                </div>
                <div class="md-menu glass-panel" id="profile-dropdown">
                    <div class="menu-header">
                        <span id="user-name-display">User</span>
                        <small>Student Account</small>
                    </div>
                    <div class="menu-divider"></div>
                    <button class="menu-item-row" onclick="window.logout()">
                        <div class="icon-box danger"><i class="fas fa-sign-out-alt"></i></div> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <div class="main-container">

        <!-- === HOME === -->
        <div id="home" class="view-section active">
            <div class="md-card hero-card animate-pop">
                <div class="hero-content">
                    <div class="hero-top">
                        <h1>Welcome Back</h1>
                        <div class="hero-icon"><i class="fas fa-graduation-cap"></i></div>
                    </div>
                    <div class="quote-container">
                        <i class="fas fa-quote-left"></i>
                        <span id="quote-text">Loading inspiration...</span>
                    </div>
                </div>
            </div>

            <div class="section-header">
                <h3>Latest Notices</h3>
            </div>
            <div id="public-notices" class="grid-layout">
                <div class="md-card outlined skeleton-card">
                    <div class="sk-line w-70"></div>
                    <div class="sk-line w-40"></div>
                </div>
            </div>

            <h4 class="section-label fade-in">Quick Menu</h4>
            <div class="quick-grid fade-in">
                <div class="quick-card ripple" onclick="window.nav('files')">
                    <div class="icon-circle small gradient-purple"><i class="fas fa-book-open"></i></div>
                    <span>Browse</span>
                </div>
                <div class="quick-card ripple" onclick="window.switchFileView('upload'); window.nav('files')">
                    <div class="icon-circle small gradient-blue"><i class="fas fa-cloud-upload-alt"></i></div>
                    <span>Upload</span>
                </div>
                <div class="quick-card ripple" onclick="window.nav('drive')">
                    <div class="icon-circle small gradient-orange"><i class="fab fa-google-drive"></i></div>
                    <span>Backup</span>
                </div>
                <div class="quick-card ripple" onclick="window.switchFileView('resources'); window.nav('files')">
                    <div class="icon-circle small gradient-green"><i class="fas fa-book"></i></div>
                    <span>Resources</span>
                </div>
            </div>
        </div>

        <!-- === LIBRARY === -->
        <div id="files" class="view-section">
            <div class="library-header fade-in">
                <h2>Library</h2>
                <div class="md-tabs pill-box">
                    <button class="tab-pill active" onclick="window.switchFileView('browse')">Browse</button>
                    <button class="tab-pill" onclick="window.switchFileView('resources')">Resources</button>
                    <button class="tab-pill" onclick="window.switchFileView('upload')">Upload</button>
                </div>
            </div>

            <div id="view-browse" class="sub-view active">
                <div class="search-wrapper animate-fade">
                    <div class="search-pill glass">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search files..." onkeyup="window.filterFiles(this.value)">
                    </div>
                </div>
                <div id="public-gallery" class="list-layout">
                    <div class="empty-state">
                        <div class="spinner"></div>
                        <p>Fetching resources...</p>
                    </div>
                </div>
            </div>

            <div id="view-resources" class="sub-view">
                <div class="md-card glass animate-pop center-content">
                    <div class="icon-circle small gradient-green" style="margin-bottom: 10px;">
                        <i class="fas fa-book"></i>
                    </div>
                    <h3>Free Study Materials</h3>
                    <p class="subtext">Curated PDFs and notes for you.</p>
                </div>
                <div id="resources-list" class="list-layout">
                    <div class="empty-state">
                        <div class="spinner"></div>
                        <p>Loading materials...</p>
                    </div>
                </div>
            </div>

            <div id="view-upload" class="sub-view">
                <div class="md-card large-padding center-text animate-pop">
                    <div class="icon-circle large pulse-anim"><i class="fas fa-cloud-upload-alt"></i></div>
                    <h3>Upload File</h3>
                    <p class="subtext">PDF, JPG, PNG (Max 10MB)</p>

                    <div class="input-group">
                        <div class="md-text-field">
                            <input type="text" id="file-title" placeholder=" ">
                            <label>File Title</label>
                            <div class="underline"></div>
                        </div>
                        <label class="file-drop-zone">
                            <i class="fas fa-folder-open"></i>
                            <span>Tap to select</span>
                            <input type="file" id="file-input" multiple accept=".pdf, .jpg, .jpeg, .png">
                        </label>
                    </div>

                    <div id="progress-container" class="linear-progress">
                        <div class="progress-bar" id="progress-fill"></div>
                    </div>
                    <p id="progress-text" class="tiny-text"></p>

                    <button id="upload-btn-el" onclick="window.uploadFile()"
                        class="md-btn gradient-btn full-width">Start Upload</button>
                </div>

                <h4 class="section-label">My History</h4>
                <div id="my-status-list" class="list-layout">
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <span>No upload history</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- === DRIVE === -->
        <div id="drive" class="view-section">
            <div class="md-card gradient-card-2 animate-pop compact-header">
                <div class="row-between">
                    <div>
                        <h2>Backup Drive</h2>
                        <p style="opacity: 0.8; font-size: 0.9rem; margin:0">External folders</p>
                    </div>
                    <i class="fab fa-google-drive" style="font-size: 2.5rem; opacity: 0.3;"></i>
                </div>
            </div>

            <h4 class="section-label fade-in">Tools</h4>
            <div class="grid-layout fade-in" style="grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));">
                <a href="https://scholar.google.com" target="_blank" class="tool-chip glass"><i
                        class="fas fa-graduation-cap" style="color:#4285F4"></i> Scholar</a>
                <a href="https://chat.openai.com" target="_blank" class="tool-chip glass"><i class="fas fa-robot"
                        style="color:#10a37f"></i> ChatGPT</a>
                <a href="https://www.wolframalpha.com" target="_blank" class="tool-chip glass"><i
                        class="fas fa-square-root-alt" style="color:#dd1100"></i> Wolfram</a>
            </div>

            <h4 class="section-label" style="margin-top: 20px;">Links</h4>
            <div id="drive-links-list" class="grid-layout">
                <div class="empty-state">
                    <i class="fas fa-folder-open"></i>
                    <span>No links available</span>
                </div>
            </div>
        </div>

        <!-- === ABOUT === -->
        <div id="about" class="view-section">
            <div class="about-wrapper animate-pop">
                <div class="md-card glass about-card">
                    <div class="center-text">
                        <div class="logo-icon glass-icon large-icon"><i class="fas fa-graduation-cap"></i></div>
                        <h2>StudentHub</h2>
                        <span class="md-chip glass-chip">v4.4 Redesign</span>
                    </div>
                    <div class="menu-divider"></div>
                    <div class="tech-stack-row">
                        <i class="fas fa-fire" style="color:#FFCA28"></i>
                        <i class="fab fa-js" style="color:#F7DF1E"></i>
                        <i class="fab fa-html5" style="color:#E34F26"></i>
                        <i class="fas fa-cloud" style="color:#3448C5"></i>
                    </div>
                </div>
                <div class="md-card glass about-card compact">
                    <div class="row-between">
                        <div class="row-gap">
                            <div class="avatar-circle"><i class="fas fa-code"></i></div>
                            <div>
                                <small>Developer</small>
                                <h4 style="margin:0">Sabbir Ahmed Rakib</h4>
                            </div>
                        </div>
                        <div class="social-row">
                            <a href="#" class="icon-btn-plain"><i class="fab fa-github"></i></a>
                            <a href="#" class="icon-btn-plain"><i class="fas fa-envelope"></i></a>
                        </div>
                    </div>
                </div>
                <p class="tiny-text center-text" style="opacity: 0.5; margin-top: 20px;">Â© 2025 StudentHub Portal.</p>
            </div>
        </div>

        <!-- === ADMIN (REDESIGNED + USER DIRECTORY FIX) === -->
        <div id="admin-dash" class="view-section">

            <div class="admin-top-bar glass animate-pop">
                <div class="row-gap">
                    <div class="icon-circle small gradient-purple"><i class="fas fa-shield-alt"></i></div>
                    <h3 style="margin:0">Dashboard</h3>
                </div>
                <button onclick="window.logoutAdmin()" class="md-btn text danger">Exit</button>
            </div>

            <!-- Navigation Tabs -->
            <div class="admin-tabs-wrapper animate-fade">
                <button class="admin-tab active" onclick="window.switchAdminTab('overview', this)"><i
                        class="fas fa-chart-pie"></i> Overview</button>
                <button class="admin-tab" onclick="window.switchAdminTab('content', this)"><i
                        class="fas fa-layer-group"></i> Content</button>
                <button class="admin-tab" onclick="window.switchAdminTab('users', this)"><i class="fas fa-users"></i>
                    Users</button>
                <button class="admin-tab" onclick="window.switchAdminTab('tools', this)"><i class="fas fa-tools"></i>
                    Tools</button>
            </div>

            <div class="admin-content-area">

                <!-- TAB 1: OVERVIEW -->
                <div id="adm-overview" class="adm-view active animate-fade">
                    <div class="stats-grid">
                        <div class="stat-card glass">
                            <div class="stat-icon"><i class="fas fa-users"></i></div>
                            <div class="stat-info">
                                <h2 id="stat-total-users">...</h2>
                                <small>Total Users</small>
                            </div>
                        </div>
                        <div class="stat-card glass">
                            <div class="stat-icon success"><i class="fas fa-wifi"></i></div>
                            <div class="stat-info">
                                <h2 id="stat-active-users">0</h2>
                                <small>Online Now</small>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-row">
                        <div class="md-card glass full-h">
                            <h4 class="card-title"><i class="fas fa-list-alt"></i> Activity Log</h4>
                            <div id="admin-activity-log" class="scroll-list h-200 console-font">
                                <div class="empty-state small">No recent activity</div>
                            </div>
                        </div>
                        <div class="md-card glass full-h">
                            <h4 class="card-title"><i class="fas fa-user-clock"></i> Active Users</h4>
                            <div id="active-user-list-specific" class="scroll-list h-200">
                                <div class="empty-state small">No users online</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB 2: CONTENT -->
                <div id="adm-content" class="adm-view">
                    <div class="md-card glass border-warning">
                        <h4 class="card-title" style="color:#f59e0b"><i class="fas fa-clock"></i> Pending Approvals</h4>
                        <div id="admin-pending-list" class="scroll-list h-300">
                            <div class="empty-state small">No pending files</div>
                        </div>
                    </div>
                </div>

                <!-- TAB 3: USERS (REDESIGNED SECTION) -->
                <div id="adm-users" class="adm-view">
                    <div class="md-card glass">
                        <h4 class="card-title" style="margin-bottom:12px;">User Directory</h4>

                        <div class="search-pill glass small-search full-width" style="margin-bottom:16px;">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Filter users..."
                                onkeyup="window.filterUserList(this.value)">
                        </div>

                        <!-- Updated Scrollable User List -->
                        <div id="all-user-list" class="user-grid-scroll">
                            <div class="empty-state">Loading users...</div>
                        </div>
                    </div>

                    <div id="master-admin-section" class="md-card tonal-primary" style="display: none;">
                        <h4 class="card-title" style="color:var(--primary)"><i class="fas fa-crown"></i> Master Control
                        </h4>
                        <div class="row-between top-align">
                            <div style="flex:1; margin-right:10px;">
                                <h5 style="margin:0 0 8px 0; color:var(--error)">Banned Users</h5>
                                <div id="banned-user-list" class="mini-list box-inset">
                                    <small>Loading...</small>
                                </div>
                            </div>
                            <div style="flex:1;">
                                <h5 style="margin:0 0 8px 0;">Sub-Admins</h5>
                                <div class="row-gap mb-2">
                                    <div class="md-text-field compact">
                                        <input type="email" id="sub-admin-email" placeholder=" ">
                                        <label>Email</label>
                                    </div>
                                    <button onclick="window.addSubAdmin()" class="icon-btn-plain"><i
                                            class="fas fa-plus-circle"
                                            style="font-size:1.5rem; color:var(--primary)"></i></button>
                                </div>
                                <div id="admin-list" class="mini-list box-inset"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB 4: TOOLS -->
                <div id="adm-tools" class="adm-view">
                    <div class="dashboard-row">
                        <!-- Add Resource -->
                        <div class="md-card glass">
                            <h4 class="card-title"><i class="fas fa-file-pdf"></i> Add Resource</h4>
                            <div class="md-text-field">
                                <input type="text" id="res-title" placeholder=" ">
                                <label>Title</label>
                            </div>
                            <div class="md-text-field">
                                <input type="text" id="res-url" placeholder=" ">
                                <label>Link (URL)</label>
                            </div>
                            <p class="divider-text">- OR UPLOAD -</p>
                            <label class="file-drop-zone small-zone">
                                <i class="fas fa-cloud-upload-alt"></i> <span>Select PDF</span>
                                <input type="file" id="res-file-input" accept=".pdf">
                            </label>
                            <div id="res-progress-container" class="linear-progress"
                                style="display:none; margin-bottom:10px;">
                                <div class="progress-bar" id="res-progress-fill"></div>
                            </div>
                            <button id="add-res-btn" onclick="window.addResource()"
                                class="md-btn gradient-btn full-width">Add to Resources</button>
                        </div>

                        <div class="col-stack">
                            <!-- Post Notice -->
                            <div class="md-card glass">
                                <h4 class="card-title"><i class="fas fa-bullhorn"></i> Post Notice</h4>
                                <div class="md-text-field">
                                    <textarea id="admin-msg" rows="2" placeholder=" "></textarea>
                                    <label>Message</label>
                                </div>
                                <div class="action-row right">
                                    <button onclick="window.postNotice()" class="md-btn gradient-btn">Post</button>
                                </div>
                            </div>

                            <!-- Drive Link -->
                            <div class="md-card glass">
                                <h4 class="card-title"><i class="fab fa-google-drive"></i> Backup Link</h4>
                                <div class="md-text-field">
                                    <input type="text" id="drive-title" placeholder=" ">
                                    <label>Title</label>
                                </div>
                                <div class="md-text-field">
                                    <input type="text" id="drive-url" placeholder=" ">
                                    <label>URL</label>
                                </div>
                                <button onclick="window.addDriveLink()" class="md-btn text full-width">Add Link</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- MOBILE BOTTOM BAR -->
    <div class="md-bottom-bar glass">
        <button class="bar-item active" onclick="window.nav('home')">
            <div class="icon-box"><i class="fas fa-home"></i></div>
            <span class="label">Home</span>
        </button>
        <button class="bar-item" onclick="window.nav('files')">
            <div class="icon-box"><i class="fas fa-folder"></i></div>
            <span class="label">Library</span>
        </button>
        <button class="bar-item" onclick="window.nav('drive')">
            <div class="icon-box"><i class="fab fa-google-drive"></i></div>
            <span class="label">Backup</span>
        </button>
        <button class="bar-item" onclick="window.nav('about')">
            <div class="icon-box"><i class="fas fa-info"></i></div>
            <span class="label">About</span>
        </button>
        <button class="bar-item" onclick="window.handleAdminClick(event)">
            <div class="icon-box warning"><i class="fas fa-shield-alt"></i></div>
            <span class="label">Admin</span>
        </button>
    </div>

    <!-- MODALS -->
    <div id="admin-modal" class="md-dialog-overlay glass-overlay">
        <div class="md-dialog animate-pop">
            <div class="dialog-icon gradient-icon"><i class="fas fa-lock"></i></div>
            <h3>Admin Access</h3>
            <p class="subtext">Enter credentials</p>
            <div class="md-text-field">
                <input type="text" id="admin-user" placeholder=" ">
                <label>User ID</label>
            </div>
            <div class="md-text-field">
                <input type="password" id="admin-pass" placeholder=" ">
                <label>Password</label>
            </div>
            <div class="dialog-actions">
                <button onclick="document.getElementById('admin-modal').style.display='none'"
                    class="md-btn text">Cancel</button>
                <button onclick="window.verifyAdmin()" class="md-btn gradient-btn">Unlock</button>
            </div>
        </div>
    </div>

    <div id="preview-modal" class="preview-overlay">
        <div class="preview-toolbar">
            <h4 id="preview-title">Preview</h4>
            <div class="preview-actions">
                <button onclick="window.switchPreviewMode('google')" class="md-chip glass-chip">Google</button>
                <button onclick="window.switchPreviewMode('native')" class="md-chip glass-chip">Native</button>
                <button onclick="window.openExternal()" class="icon-btn-plain"><i
                        class="fas fa-external-link-alt"></i></button>
                <button onclick="window.closePreview()" class="icon-btn-plain"><i class="fas fa-times"></i></button>
            </div>
        </div>
        <div id="preview-body" class="preview-content"></div>
    </div>

    <div id="toast-box" class="snackbar-container"></div>

    <script type="module" src="script.js"></script>
</body>

</html>